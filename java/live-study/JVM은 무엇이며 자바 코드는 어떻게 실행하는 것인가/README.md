# JVM은 무엇이며 자바 코드는 어떻게 실행하는 것인가.

## JVM이란
JVM(*Java Virtual Machine*)이란 단어의 뜻 그대로 자바를 실행하는 가상 머신입니다. 네이티브 코드를 실행하는 것이 아닌 바이트 코드를 JVM에 실행하도록 함으로써 개발자가 운영체제를 신경쓰지 않고 코드를 작성할 수 있도록 합니다. 뿐만 아니라 내장 되어있는 가비지 컬렉터가 특정 시점에 불필요하다 판단되는 자원을 알아서 해제해주기 때문에, 개발자가 자원 전체를 관리할 필요가 없어 코드 작성시 부담을 줄여줍니다. 하지만 JVM만 믿고 무분별하게 코드를 작성하게 되면 메모리 누수를 발생시킬 수 있기 때문에 자바 개발자라면 JVM에 대해 제대로 이해하고 코드를 작성할 수 있어야 할 것입니다. JVM은 원래 자바를 실행하기 위한 목적으로 만들어졌지만 현재는 코틀린, 스칼라 등과 같은 언어들도 지원하고 있습니다.

## 컴파일 및 실행하기
일단 컴파일을 하기 위해서는 JDK라는 도구를 설치해야 합니다. 여기서는 이미 JDK가 설치되었다고 가정하고 설명을 하겠습니다(Open JDK는 [이곳](https://github.com/ojdkbuild/ojdkbuild)에서 다운 받을 수 있습니다).  
다운을 받게 되면 bin이라는 폴더 안에 javac라는 파일이 보일 것입니다. 이 것이 바로 자바 컴파일러이며 java 파일을 class 파일로 변환해 주는 도구입니다. 먼저 java 파일을 작성해 보겠습니다. 간단하게 텍스트 파일을 열어 작성해 봅시다.

filename: MyClass.java
~~~java
public class MyClass {
    public static void main(String[] args) {
        System.out.print("Hello World!");
    }
}
~~~

java 파일을 작성한 후에는 파일이 있는 경로로 들어간 후 `javac`를 사용하여 컴파일 해 봅시다.

~~~
$ javac MyClass
~~~

명령어를 입력하게 되면 같은 폴더에 `MyClass.class`라는 파일이 생성되었을 것입니다. 이 파일이 바로 바이트 코드가 저장되어 있는 class 파일입니다. 이제 컴파일된 class 파일을 `java` 명령어를 통해 실행해 봅시다.

~~~
$ java MyClass

Hello World!
~~~

## 바이트 코드란 무엇인가

바이트 코드란 사람이 이해할 수 있도록 작성된 `java` 파일을 JVM이 이해할 수 있도록 컴파일한 코드입니다. `class`파일 내부에 작성되어 있으며 `javap`를 통해 개발자가 알아볼 수 있도록 변환할 수 있습니다.

~~~
$ javap MyClass

Compiled from "MyClass.java"
public class MyClass {
  public MyClass();
  public static void main(java.lang.String[]);
}
~~~

바이트 코드는 네이티브 코드가 아니기 때문에 하드웨어에서 바로 실행할 수 없어서 C나 C++과 같이 기계어로 컴파일 되어 실행되는 언어에 비해 속도가 느립니다. 하지만 후술할 JIT 컴파일러를 통해 어느정도 속도를 보장할 수 있게 되었습니다.

## JIT 컴파일러란 무엇이며 어떻게 동작하는가

바이트 코드는 운영체제에서 직접 실행되는 것이 아니라 JVM을 통해 해석된 후 실행되기 때문에 인터프리터 방식이라고 할 수 있습니다. 인터프리터 방식은 코드를 그때그때 한 줄씩 읽어서 해석하고 실행하게 되는데, 똑같은 코드를 매번 읽고 해석 하는 것은 매우 불필요한 일입니다. 그래서 JIT(Just-In-Time) 컴파일러가 도입되었습니다. JIT 컴파일러는 자주 실행되는 영역을 파악한 후 해당 코드만을 컴파일하고 최적화하여 기계어로 만든 다음, 이 후에 실행시 기계어로 바로 실행될 수 있도록 합니다. 짧은 코드의 경우 한 번만 실행하면 되기 때문에 인터프리터 방식이 JIT 컴파일 방식 보다 빠르겠지만 애플리케이션에서는 반복적으로 코드를 실행하는 경우가 대부분이기 때문에 JIT 컴파일처럼 미리 기계어로 컴파일을 해놓고 실행하는 것이 효율적입니다.

## JVM의 구성요소



## JDK와 JRE의 차이


## 참고
https://m.blog.naver.com/2feelus/220738480797
